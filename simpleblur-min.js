(function(v){function t(a,b,f){var d=b.blurring_average||4,e=b.blurring_iterations||3,g=b.scaledown_percentage||.1,n=b.widthTopCap||1200,k=b.widthBottomCap||600,h;b="blurImage"+a.src+a.offsetWidth+d+e+g;for(var l=r.w,p,m=0;m<localStorage.length;m++)localStorage.removeItem("picCache");if(r.storageAvailable){p=JSON.parse(localStorage.getItem("picCache"))||{cacheKey:{}};if("undefined"!==typeof p[r.w])var c=p[r.w][b];"undefined"!==typeof c&&null!==c&&(h=c)}if("undefined"===typeof h){h=document.createElement("canvas");
"undefined"!==typeof f?(c=f.offsetWidth,m=f.offsetHeight):(c=a.offsetWidth,m=a.offsetHeight);c>n&&(l=n/c,c*=l,m*=l,l=c);c<k&&(l=k/c,c*=l,m*=l,l=c);h.setAttribute("width",c*g+"px");h.setAttribute("height",m*g+"px");h.crossOrigin="Anonymous";g=h.getContext("2d");g.drawImage(a,0,0,h.width,h.height);n=g.getImageData(0,0,h.width,h.height);k=n.data;c=h.width;for(m=0;m<e;m++)for(var q=0;q<k.length;q+=4)k[q]=u(q,k,c,d),k[q+1]=u(q+1,k,c,d),k[q+2]=u(q+2,k,c,d);g.putImageData(n,0,0);h=h.toDataURL("image/png");
if(r.storageAvailable){"undefined"==typeof p[l]&&(p[l]={},"undefined"==typeof p[l][b]&&(p[l][b]={}));p[l][b]=h;try{localStorage.setItem("picCache",JSON.stringify(p))}catch(t){t&&(console.log("Quota exceeded!"),console.log(localStorage))}}}"undefined"!==typeof f?f.style.backgroundImage="url("+h+")":a.src=h}function u(a,b,f,d){for(var e=-Math.floor(d/2),g=0,n=e;n<d+e;n++)for(var k=e;k<d+e;k++)g+=b[a+4*n*f+4*k]||b[a];return g/(d*d)}function w(a,b){if(a instanceof HTMLImageElement)if(x(a))t(a,b);else var f=
0,d=setInterval(function(){x(a)?(clearInterval(d),t(a,b)):(f++,3<f&&clearInterval(d))},25*f);else{var e=y(a)["background-image"].replace("url(","").slice(0,-2),e=e.replace("&quot;",""),e=e.replace('"',""),g=new Image;g.onload=function(){t(g,b,a)};g.src=e}}function x(a){return!a.complete||"undefined"!=typeof a.naturalWidth&&0==a.naturalWidth?!1:!0}function y(a){for(var b="width height opacity background-image background-repeat background-position background-color margin-right margin-left margin-top margin-bottom".split(" "),
f={},d="undefined"!==getComputedStyle,e=0,g=b.length;e<g;e++)f[b[e]]=d?getComputedStyle(a,null).getPropertyValue(b[e]):a.currentStyle[b[e]];return f}var r={};v.simpleblur=function(a,b){r.w=v.innerWidth;r.storageAvailable="undefined"!==typeof Storage&&"undefined"===typeof b.cache&&!1!==b.cache?!0:!1;for(var f=document.querySelectorAll(a||"#simpleBlurTarget"),d=0;d<f.length;d++)w(f[d],b)};"undefined"!==typeof jQuery&&(jQuery.fn.simpleblur=function(a){r.storageAvailable="undefined"!==typeof Storage?
!0:!1;return this.each(function(b){w(this,a)})})})(window);
