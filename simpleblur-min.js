(function(v){function r(a,b,f){var c=b.blurring_average||4,d=b.blurring_iterations||3,g=b.scaledown_percentage||.1,k=b.widthTopCap||1200,l=b.widthBottomCap||600,h;b="blurImage"+a.src+a.offsetWidth+c+d+g;var t=q.w,m;if(q.storageAvailable){m=JSON.parse(localStorage.getItem("picCache"))||{cacheKey:{}};if("undefined"!==typeof m[q.w])var e=m[q.w][b];"undefined"!==typeof e&&null!==e&&(h=e)}if("undefined"===typeof h){h=document.createElement("canvas");if("undefined"!==typeof f)var e=f.offsetWidth,n=f.offsetHeight;
else e=a.offsetWidth,n=a.offsetHeight;e>k&&(k/=e,e*=k,n*=k);e<l&&(k=l/e,e*=k,n*=k);h.setAttribute("width",e*g+"px");h.setAttribute("height",n*g+"px");h.crossOrigin="Anonymous";g=h.getContext("2d");g.drawImage(a,0,0,h.width,h.height);k=g.getImageData(0,0,h.width,h.height);l=k.data;e=h.width;for(n=0;n<d;n++)for(var p=0;p<l.length;p+=4)l[p]=u(p,l,e,c),l[p+1]=u(p+1,l,e,c),l[p+2]=u(p+2,l,e,c);g.putImageData(k,0,0);h=h.toDataURL("image/png");if(q.storageAvailable){"undefined"==typeof m[t]&&(m[t]={},"undefined"==
typeof m[t][b]&&(m[t][b]={}));m[t][b]=h;try{localStorage.setItem("picCache",JSON.stringify(m))}catch(r){r&&console.log("Quota exceeded!")}}}"undefined"!==typeof f?f.style.backgroundImage="url("+h+")":a.src=h}function u(a,b,f,c){for(var d=-Math.floor(c/2),g=0,k=d;k<c+d;k++)for(var l=d;l<c+d;l++)g+=b[a+4*k*f+4*l]||b[a];return g/(c*c)}function w(a,b){if(a instanceof HTMLImageElement)if(x(a))r(a,b);else var f=0,c=setInterval(function(){x(a)?(clearInterval(c),r(a,b)):(f++,3<f&&clearInterval(c))},25*f);
else{var d=y(a)["background-image"].replace("url(","").slice(0,-2),d=d.replace("&quot;",""),d=d.replace('"',""),g=new Image;g.onload=function(){r(g,b,a)};g.src=d}}function x(a){return!a.complete||"undefined"!=typeof a.naturalWidth&&0==a.naturalWidth?!1:!0}function y(a){for(var b="width height opacity background-image background-repeat background-position background-color margin-right margin-left margin-top margin-bottom".split(" "),f={},c="undefined"!==getComputedStyle,d=0,g=b.length;d<g;d++)f[b[d]]=
c?getComputedStyle(a,null).getPropertyValue(b[d]):a.currentStyle[b[d]];return f}var q={};v.simpleblur=function(a,b){q.w=v.innerWidth;q.storageAvailable="undefined"!==typeof Storage&&"undefined"===typeof b.cache&&!1!==b.cache?!0:!1;for(var f=document.querySelectorAll(a||"#simpleBlurTarget"),c=0;c<f.length;c++)w(f[c],b)};"undefined"!==typeof jQuery&&(jQuery.fn.simpleblur=function(a){q.storageAvailable="undefined"!==typeof Storage?!0:!1;return this.each(function(b){w(this,a)})})})(window);
